[gd_scene load_steps=21 format=3 uid="uid://bhrdjha0g10ow"]

[ext_resource type="PackedScene" uid="uid://bynkfykxpprpw" path="res://scenes/common/Player.tscn" id="1_qg8n7"]
[ext_resource type="Script" path="res://scripts/items/PickableItem.cs" id="2_item1"]
[ext_resource type="Script" path="res://scripts/ui/InventoryUI.cs" id="3_invui"]
[ext_resource type="Script" path="res://scripts/levels/GameSetup.cs" id="4_setup"]
[ext_resource type="Script" path="res://scripts/ui/BookUI.cs" id="5_bookui"]
[ext_resource type="Script" path="res://scripts/items/BookItem.cs" id="6_bookitem"]
[ext_resource type="Script" path="res://scripts/ui/PuzzleUI.cs" id="7_puzzleui"]
[ext_resource type="Script" path="res://scripts/puzzles/DoorPuzzle.cs" id="8_doorpuzzle"]

[sub_resource type="BoxMesh" id="BoxMesh_floor"]
size = Vector3(20, 0.2, 20)

[sub_resource type="BoxShape3D" id="BoxShape3D_floor"]
size = Vector3(20, 0.2, 20)

[sub_resource type="SphereMesh" id="SphereMesh_item"]
radius = 0.3
height = 0.6

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_crystal"]
albedo_color = Color(0.5, 0.2, 1, 1)
emission_enabled = true
emission = Color(0.7, 0.3, 1, 1)
emission_energy_multiplier = 1.5

[sub_resource type="SphereShape3D" id="SphereShape3D_item"]
radius = 0.3

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_coin"]
albedo_color = Color(1, 0.84, 0, 1)
metallic = 0.8
roughness = 0.2

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_potion"]
albedo_color = Color(0, 1, 0.3, 1)
emission_enabled = true
emission = Color(0, 1, 0.5, 1)
emission_energy_multiplier = 0.8

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_book"]
albedo_color = Color(0.6, 0.4, 0.2, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_door"]
albedo_color = Color(0.6, 0.2, 0.2, 1)

[sub_resource type="BoxMesh" id="BoxMesh_door"]
material = SubResource("StandardMaterial3D_door")
size = Vector3(4, 4, 0.3)

[sub_resource type="BoxShape3D" id="BoxShape3D_door"]
size = Vector3(4, 4, 0.3)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_panel"]
albedo_color = Color(0.2, 0.3, 0.5, 1)
emission_enabled = true
emission = Color(0.3, 0.6, 1, 1)
emission_energy_multiplier = 2.0

[node name="Main" type="Node3D"]

[node name="GameSetup" type="Node" parent="."]
script = ExtResource("4_setup")

[node name="Player" parent="." instance=ExtResource("1_qg8n7")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)

[node name="Floor" type="StaticBody3D" parent="."]

[node name="MeshInstance3D" type="MeshInstance3D" parent="Floor"]
mesh = SubResource("BoxMesh_floor")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Floor"]
shape = SubResource("BoxShape3D_floor")

[node name="FloorRoom2" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -20, 0, 0)
use_collision = true
size = Vector3(20, 0.2, 20)

[node name="Walls" type="Node3D" parent="."]

[node name="WallNorth" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.5, -10)
use_collision = true
size = Vector3(20, 5, 0.2)

[node name="WallSouth" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.5, 10)
use_collision = true
size = Vector3(20, 5, 0.2)

[node name="WallEast" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 2.5, 0)
use_collision = true
size = Vector3(0.2, 5, 20)

[node name="WallWestNorth" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 2.5, -6)
use_collision = true
size = Vector3(0.2, 5, 8)

[node name="WallWestSouth" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 2.5, 6)
use_collision = true
size = Vector3(0.2, 5, 8)

[node name="WallWestRoom2" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -30, 2.5, 0)
use_collision = true
size = Vector3(0.2, 5, 20)

[node name="WallNorthRoom2" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -20, 2.5, -10)
use_collision = true
size = Vector3(20, 5, 0.2)

[node name="WallSouthRoom2Left" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -26, 2.5, 10)
use_collision = true
size = Vector3(8, 5, 0.2)

[node name="WallSouthRoom2Right" type="CSGBox3D" parent="Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -14, 2.5, 10)
use_collision = true
size = Vector3(8, 5, 0.2)

[node name="Ceiling" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5, 0)
visible = false
use_collision = true
size = Vector3(20, 0.2, 20)

[node name="Items" type="Node3D" parent="."]

[node name="PickableItem1" type="StaticBody3D" parent="Items"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3, 0.5, 2)
script = ExtResource("2_item1")
ItemId = "crystal"
ItemName = "Crystal"

[node name="MeshInstance3D" type="MeshInstance3D" parent="Items/PickableItem1"]
mesh = SubResource("SphereMesh_item")
surface_material_override/0 = SubResource("StandardMaterial3D_crystal")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Items/PickableItem1"]
shape = SubResource("SphereShape3D_item")

[node name="PickableItem2" type="StaticBody3D" parent="Items"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 0.5, -3)
script = ExtResource("2_item1")
ItemId = "coin"
ItemName = "Coin"

[node name="MeshInstance3D" type="MeshInstance3D" parent="Items/PickableItem2"]
mesh = SubResource("SphereMesh_item")
surface_material_override/0 = SubResource("StandardMaterial3D_coin")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Items/PickableItem2"]
shape = SubResource("SphereShape3D_item")

[node name="PickableItem3" type="StaticBody3D" parent="Items"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 0.5, -5)
script = ExtResource("2_item1")
ItemId = "potion"
ItemName = "Potion"
MaxStackSize = 16

[node name="MeshInstance3D" type="MeshInstance3D" parent="Items/PickableItem3"]
mesh = SubResource("SphereMesh_item")
surface_material_override/0 = SubResource("StandardMaterial3D_potion")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Items/PickableItem3"]
shape = SubResource("SphereShape3D_item")

[node name="BookItem1" type="StaticBody3D" parent="Items"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 6)
script = ExtResource("6_bookitem")
BookTitle = "The Lost Chronicles"
BookContent = "[center][b]The Lost Chronicles[/b][/center]

[i]An ancient tome from a forgotten age...[/i]

In the beginning, there was darkness. Not the comforting darkness of night, but an endless void that stretched beyond comprehension.

From this void came the First Light, a brilliant spark that illuminated the emptiness and gave birth to all that we know.

[b]Chapter I: The Creation[/b]

The ancients speak of a time when the world was young and magic flowed freely through the land like rivers of pure energy.

Great towers rose from the earth, their spires touching the heavens. Within these towers, the Mages of Old practiced their craft, weaving reality itself with mere thoughts.

[b]Chapter II: The Fall[/b]

But pride comes before destruction. The mages sought to become gods, to command the very fabric of existence. Their hubris brought about the Great Cataclysm.

The towers fell, the magic scattered, and the world was forever changed.

[b]Chapter III: The Prophecy[/b]

Yet hope remains. It is written that one day, a chosen one will arise. They will gather the fragments of the ancient power and restore balance to the world.

[i]\"When darkness returns and light fades,
When heroes fall and hope decays,
Look to the stars for guidance true,
The chosen one shall see it through.\"[/i]

[right]- End of Volume I -[/right]"
ItemId = "ancient_book"
ItemName = "Ancient Book"
MaxStackSize = 1

[node name="MeshInstance3D" type="MeshInstance3D" parent="Items/BookItem1"]
mesh = SubResource("SphereMesh_item")
surface_material_override/0 = SubResource("StandardMaterial3D_book")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Items/BookItem1"]
shape = SubResource("SphereShape3D_item")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, -0.75, 0.433013, 0, 5, 0)
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]

[node name="Obstacles" type="Node3D" parent="."]

[node name="Box1" type="CSGBox3D" parent="Obstacles"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3, 0.5, 5)
use_collision = true
size = Vector3(2, 1, 2)

[node name="Box2" type="CSGBox3D" parent="Obstacles"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6, 0.75, 4)
use_collision = true
size = Vector3(1.5, 1.5, 1.5)

[node name="PuzzleDoor" type="StaticBody3D" parent="."]
transform = Transform3D(0, 0, 1, 0, 1, 0, -1, 0, 0, -10.1, 2, 0)
script = ExtResource("8_doorpuzzle")

[node name="MeshInstance3D" type="MeshInstance3D" parent="PuzzleDoor"]
mesh = SubResource("BoxMesh_door")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PuzzleDoor"]
shape = SubResource("BoxShape3D_door")

[node name="ControlPanel" type="CSGBox3D" parent="."]
transform = Transform3D(0, 0, 1, 0, 1, 0, -1, 0, 0, -9.65125, 2, -2.5)
size = Vector3(0.3, 0.8, 0.5)
material = SubResource("StandardMaterial3D_panel")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="InventoryUI" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("3_invui")

[node name="BookUI" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("5_bookui")

[node name="PuzzleUI" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("7_puzzleui")
